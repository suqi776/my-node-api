import{cH as C,r as o}from"./index-Cvt6w_YP.js";import{a}from"./request-ChkO45HW.js";import{a as r,g as n,b as v,c as y}from"./Date-D8F-ftyC.js";const F=C("info",()=>{let e=sessionStorage.getItem("userId");e&&(e=localStorage.getItem("userId"));const i=o([]),d=o([]),D=o([]),u=o([]),f=o([]),h=o([]),p=o([]),I=o([]);async function w(){a.post("/info/getInfoByDate",{userId:e,date:r(n(new Date))}).then(t=>{i.value=t.data}).catch(t=>{console.error("失败:",t)}),a.post("/info/getInfoByDate",{userId:e,date:r(v(n(new Date),1,"day"))}).then(t=>{d.value=t.data}).catch(t=>{console.error("失败:",t)}),a.post("/info/getInfoByDateRange",{userId:e,fromDate:r(v(n(new Date),7,"day")),toDate:r(n(new Date))}).then(t=>{D.value=t.data}).catch(t=>{console.error("失败:",t)}),a.post("/info/getInfoByDateRange",{userId:e,fromDate:r(y(n(new Date)).split(" ~ ")[0]),toDate:r(y(n(new Date)).split(" ~ ")[1])}).then(t=>{u.value=t.data}).catch(t=>{console.error("失败:",t)}),a.post("/info/getInfoFoodByUserId",{userId:e}).then(t=>{f.value=t.data.food;const s={};f.value.forEach(l=>{l&&l.replace(/，/g,",").split(",").map(g=>g.trim()).forEach(g=>{s[g]=(s[g]||0)+1})});const c=Object.entries(s).sort((l,m)=>m[1]-l[1]).slice(0,5),B=Object.fromEntries(c);f.value=B}).catch(t=>{console.error("失败:",t)}),a.post("/info/getTargetWeight",{userId:e}).then(t=>{h.value=t.data}).catch(t=>{console.error("失败:",t)}),a.post("/info/getUserAvatar",{userId:e}).then(t=>{I.value=t.data}).catch(t=>{console.error("失败:",t)}),a.post("/info/getAllUserInfo",{userId:e}).then(t=>{const s=t.data.map(c=>({...c,latestDate:c.latestDate?n(c.latestDate):null}));p.value=s}).catch(t=>{console.error("失败:",t)})}return{toDayInfo:i,yesterDayInfo:d,getToDayInfo:w,echartsData:D,echartsWeekRangeData:u,getInfoFood:f,targetWeight:h,userInfo:p,userAvatar:I}});export{F as u};
